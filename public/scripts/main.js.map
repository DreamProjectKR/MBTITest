{
  "version": 3,
  "sources": ["../../src/scripts/legacy/main.js"],
  "sourcesContent": ["/**\n * Home page controller (`public/index.html` -> `public/scripts/main.js`).\n *\n * What it does:\n * - Fetches the test index from the API (`/api/tests`).\n * - Renders two sections (newest/top) and wires up clicks to `testintro.html?testId=...`.\n * - Handles the sticky header UI on scroll.\n */\nconst header = document.getElementById(\"header\");\nconst headerScroll = document.getElementById(\"headerScroll\");\nconst MainTop = document.getElementById(\"MainTop\");\n// `config.js` usually defines `window.ASSETS_BASE` and `window.assetUrl`.\n// Production default: same-origin `/assets/*` (served by Pages Functions proxy).\nconst ASSETS_BASE = window.ASSETS_BASE || \"\";\n/**\n * Build an absolute URL for assets (images/json) stored under `assets/` in R2.\n * Accepts absolute URLs and returns them unchanged.\n * @param {string} path\n * @returns {string}\n */\nconst assetUrl =\n  window.assetUrl ||\n  ((path) => {\n    if (!path) return \"\";\n    if (/^https?:\\/\\//i.test(path)) return path;\n    let clean = String(path).replace(/^\\.?\\/+/, \"\");\n    clean = clean.replace(/^assets\\/+/i, \"\");\n    return `${ASSETS_BASE}/${clean}`.replace(/\\/{2,}/g, \"/\");\n  });\n\n// \uD5E4\uB354 \uC6D0\uB798 \uC704\uCE58 \uC800\uC7A5 (\uC2A4\uD06C\uB864\uB85C fixed \uC804\uD658 \uC2DC \uAE30\uC900\uC810)\nconst headerOffset = header.offsetTop;\n\nwindow.addEventListener(\"scroll\", () => {\n  if (window.scrollY > headerOffset) {\n    header.classList.add(\"fixed-header\", \"bg-on\");\n  } else {\n    header.classList.remove(\"fixed-header\", \"bg-on\");\n  }\n});\n\n// ----- \uC720\uD2F8: \uC378\uB124\uC77C \uACBD\uB85C \uBCF4\uC815 -----\nfunction resolveThumbnailPath(thumbnail) {\n  if (!thumbnail) return \"#\";\n  if (thumbnail.startsWith(\"http\")) return thumbnail;\n  return assetUrl(thumbnail);\n}\n\n// ----- \uCE74\uB4DC DOM \uC0DD\uC131 -----\nfunction createTestCard(test, variantClass) {\n  const shell = document.createElement(\"div\");\n  shell.className = `NewTestShell ${variantClass}`;\n\n  const card = document.createElement(\"div\");\n  card.className = \"NewTest\";\n\n  const img = document.createElement(\"img\");\n  img.src = resolveThumbnailPath(test.thumbnail);\n  img.alt = test.title || \"\uD14C\uC2A4\uD2B8 \uC774\uBBF8\uC9C0\";\n\n  const title = document.createElement(\"h4\");\n  title.textContent = test.title || \"\uD14C\uC2A4\uD2B8 \uC774\uB984\";\n\n  const tagBox = document.createElement(\"div\");\n  tagBox.className = \"NewTestHashTag\";\n  const tags = Array.isArray(test.tags) ? test.tags : [];\n  tagBox.innerHTML = tags\n    .slice(0, 3)\n    .map((tag) => `<span class=\"HashTag\">#${tag}</span>`)\n    .join(\"\");\n\n  card.appendChild(img);\n  card.appendChild(title);\n  card.appendChild(tagBox);\n  shell.appendChild(card);\n\n  // \uCE74\uB4DC \uD074\uB9AD \uC2DC \uC774\uB3D9\n  shell.onclick = () => {\n    const dest = `testintro.html?testId=${encodeURIComponent(test.id || \"\")}`;\n    window.location.href = dest;\n  };\n\n  return shell;\n}\n\n// ----- \uD14C\uC2A4\uD2B8 \uBAA9\uB85D \uBD88\uB7EC\uC624\uAE30 (default: /assets/index.json) -----\nasync function fetchTestsAjax() {\n  if (typeof window.getTestIndex === \"function\") {\n    const data = await window.getTestIndex();\n    return Array.isArray(data?.tests) ? data.tests : [];\n  }\n  const url = window.TEST_INDEX_URL || \"/assets/index.json\";\n  const res = await fetch(url);\n  if (!res.ok) throw new Error(url + \" \uC694\uCCAD \uC2E4\uD328: \" + res.status);\n  const data = await res.json();\n  return Array.isArray(data?.tests) ? data.tests : [];\n}\n\n// ----- \uC911\uBCF5 \uC81C\uAC70 + \uCD5C\uC2E0\uC21C \uC815\uB82C -----\nfunction normalizeTests(tests) {\n  const seen = new Set();\n  const deduped = [];\n  for (const t of tests) {\n    const key = `${t.id}-${t.path}`;\n    if (seen.has(key)) continue;\n    seen.add(key);\n    deduped.push(t);\n  }\n  deduped.sort((a, b) => {\n    const ad = new Date(a.updatedAt || a.createdAt || 0);\n    const bd = new Date(b.updatedAt || b.createdAt || 0);\n    return bd - ad; // \uCD5C\uC2E0 \uC6B0\uC120\n  });\n  return deduped.map((t) => ({\n    ...t,\n    thumbnail: resolveThumbnailPath(t.thumbnail),\n  }));\n}\n\n// ----- \uC139\uC158\uBCC4\uB85C \uC21C\uC11C\uB300\uB85C \uCC44\uC6B0\uAE30 -----\nfunction renderSections(tests) {\n  const newTestLists = document.querySelectorAll(\".NewTestList\");\n  const newSection = newTestLists[0];\n  const topSection = newTestLists[1];\n\n  if (!newSection || !topSection) return;\n\n  const newShellContainer = newSection.querySelector(\".NewTestListShell\");\n  const topShellContainer = topSection.querySelector(\".NewTestListShell\");\n\n  if (newShellContainer) newShellContainer.innerHTML = \"\";\n  if (topShellContainer) topShellContainer.innerHTML = \"\";\n\n  // newtest \uC139\uC158: \uCD5C\uB300 4\uAC1C\n  const newTests = tests.slice(0, Math.min(4, tests.length));\n  newTests.forEach((test) => {\n    if (newShellContainer) {\n      newShellContainer.appendChild(createTestCard(test, \"newtest\"));\n    }\n  });\n\n  // toptest \uC139\uC158: \uCD5C\uB300 8\uAC1C\n  const topTests = tests.slice(0, Math.min(8, tests.length));\n  topTests.forEach((test) => {\n    if (topShellContainer) {\n      topShellContainer.appendChild(createTestCard(test, \"toptest\"));\n    }\n  });\n}\n\n// ----- \uCD08\uAE30\uD654 -----\nfunction initTestSectionsAjax() {\n  fetchTestsAjax()\n    .then(normalizeTests)\n    .then(renderSections)\n    .catch((err) => console.error(\"\uD14C\uC2A4\uD2B8 \uBAA9\uB85D \uB85C\uB529 \uC2E4\uD328:\", err));\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", initTestSectionsAjax);\n"],
  "mappings": ";AAQA,IAAM,SAAS,SAAS,eAAe,QAAQ;AAC/C,IAAM,eAAe,SAAS,eAAe,cAAc;AAC3D,IAAM,UAAU,SAAS,eAAe,SAAS;AAGjD,IAAM,cAAc,OAAO,eAAe;AAO1C,IAAM,WACJ,OAAO,aACN,CAAC,SAAS;AACT,MAAI,CAAC,KAAM,QAAO;AAClB,MAAI,gBAAgB,KAAK,IAAI,EAAG,QAAO;AACvC,MAAI,QAAQ,OAAO,IAAI,EAAE,QAAQ,WAAW,EAAE;AAC9C,UAAQ,MAAM,QAAQ,eAAe,EAAE;AACvC,SAAO,GAAG,WAAW,IAAI,KAAK,GAAG,QAAQ,WAAW,GAAG;AACzD;AAGF,IAAM,eAAe,OAAO;AAE5B,OAAO,iBAAiB,UAAU,MAAM;AACtC,MAAI,OAAO,UAAU,cAAc;AACjC,WAAO,UAAU,IAAI,gBAAgB,OAAO;AAAA,EAC9C,OAAO;AACL,WAAO,UAAU,OAAO,gBAAgB,OAAO;AAAA,EACjD;AACF,CAAC;AAGD,SAAS,qBAAqB,WAAW;AACvC,MAAI,CAAC,UAAW,QAAO;AACvB,MAAI,UAAU,WAAW,MAAM,EAAG,QAAO;AACzC,SAAO,SAAS,SAAS;AAC3B;AAGA,SAAS,eAAe,MAAM,cAAc;AAC1C,QAAM,QAAQ,SAAS,cAAc,KAAK;AAC1C,QAAM,YAAY,gBAAgB,YAAY;AAE9C,QAAM,OAAO,SAAS,cAAc,KAAK;AACzC,OAAK,YAAY;AAEjB,QAAM,MAAM,SAAS,cAAc,KAAK;AACxC,MAAI,MAAM,qBAAqB,KAAK,SAAS;AAC7C,MAAI,MAAM,KAAK,SAAS;AAExB,QAAM,QAAQ,SAAS,cAAc,IAAI;AACzC,QAAM,cAAc,KAAK,SAAS;AAElC,QAAM,SAAS,SAAS,cAAc,KAAK;AAC3C,SAAO,YAAY;AACnB,QAAM,OAAO,MAAM,QAAQ,KAAK,IAAI,IAAI,KAAK,OAAO,CAAC;AACrD,SAAO,YAAY,KAChB,MAAM,GAAG,CAAC,EACV,IAAI,CAAC,QAAQ,0BAA0B,GAAG,SAAS,EACnD,KAAK,EAAE;AAEV,OAAK,YAAY,GAAG;AACpB,OAAK,YAAY,KAAK;AACtB,OAAK,YAAY,MAAM;AACvB,QAAM,YAAY,IAAI;AAGtB,QAAM,UAAU,MAAM;AACpB,UAAM,OAAO,yBAAyB,mBAAmB,KAAK,MAAM,EAAE,CAAC;AACvE,WAAO,SAAS,OAAO;AAAA,EACzB;AAEA,SAAO;AACT;AAGA,eAAe,iBAAiB;AAC9B,MAAI,OAAO,OAAO,iBAAiB,YAAY;AAC7C,UAAMA,QAAO,MAAM,OAAO,aAAa;AACvC,WAAO,MAAM,QAAQA,OAAM,KAAK,IAAIA,MAAK,QAAQ,CAAC;AAAA,EACpD;AACA,QAAM,MAAM,OAAO,kBAAkB;AACrC,QAAM,MAAM,MAAM,MAAM,GAAG;AAC3B,MAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,MAAM,iCAAa,IAAI,MAAM;AAC1D,QAAM,OAAO,MAAM,IAAI,KAAK;AAC5B,SAAO,MAAM,QAAQ,MAAM,KAAK,IAAI,KAAK,QAAQ,CAAC;AACpD;AAGA,SAAS,eAAe,OAAO;AAC7B,QAAM,OAAO,oBAAI,IAAI;AACrB,QAAM,UAAU,CAAC;AACjB,aAAW,KAAK,OAAO;AACrB,UAAM,MAAM,GAAG,EAAE,EAAE,IAAI,EAAE,IAAI;AAC7B,QAAI,KAAK,IAAI,GAAG,EAAG;AACnB,SAAK,IAAI,GAAG;AACZ,YAAQ,KAAK,CAAC;AAAA,EAChB;AACA,UAAQ,KAAK,CAAC,GAAG,MAAM;AACrB,UAAM,KAAK,IAAI,KAAK,EAAE,aAAa,EAAE,aAAa,CAAC;AACnD,UAAM,KAAK,IAAI,KAAK,EAAE,aAAa,EAAE,aAAa,CAAC;AACnD,WAAO,KAAK;AAAA,EACd,CAAC;AACD,SAAO,QAAQ,IAAI,CAAC,OAAO;AAAA,IACzB,GAAG;AAAA,IACH,WAAW,qBAAqB,EAAE,SAAS;AAAA,EAC7C,EAAE;AACJ;AAGA,SAAS,eAAe,OAAO;AAC7B,QAAM,eAAe,SAAS,iBAAiB,cAAc;AAC7D,QAAM,aAAa,aAAa,CAAC;AACjC,QAAM,aAAa,aAAa,CAAC;AAEjC,MAAI,CAAC,cAAc,CAAC,WAAY;AAEhC,QAAM,oBAAoB,WAAW,cAAc,mBAAmB;AACtE,QAAM,oBAAoB,WAAW,cAAc,mBAAmB;AAEtE,MAAI,kBAAmB,mBAAkB,YAAY;AACrD,MAAI,kBAAmB,mBAAkB,YAAY;AAGrD,QAAM,WAAW,MAAM,MAAM,GAAG,KAAK,IAAI,GAAG,MAAM,MAAM,CAAC;AACzD,WAAS,QAAQ,CAAC,SAAS;AACzB,QAAI,mBAAmB;AACrB,wBAAkB,YAAY,eAAe,MAAM,SAAS,CAAC;AAAA,IAC/D;AAAA,EACF,CAAC;AAGD,QAAM,WAAW,MAAM,MAAM,GAAG,KAAK,IAAI,GAAG,MAAM,MAAM,CAAC;AACzD,WAAS,QAAQ,CAAC,SAAS;AACzB,QAAI,mBAAmB;AACrB,wBAAkB,YAAY,eAAe,MAAM,SAAS,CAAC;AAAA,IAC/D;AAAA,EACF,CAAC;AACH;AAGA,SAAS,uBAAuB;AAC9B,iBAAe,EACZ,KAAK,cAAc,EACnB,KAAK,cAAc,EACnB,MAAM,CAAC,QAAQ,QAAQ,MAAM,8DAAiB,GAAG,CAAC;AACvD;AAEA,SAAS,iBAAiB,oBAAoB,oBAAoB;",
  "names": ["data"]
}
